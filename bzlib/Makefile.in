SHELL = /bin/sh

top_srcdir = @top_srcdir@

CC = @CC@
LD = @LD@
cppflags = -I$(top_srcdir)/include @CPPFLAGS@ -DBZ_NO_STDIO
CFLAGS = @ZLIB_CFLAGS@ $(cppflags)
BZFILE_CFLAGS = @CFLAGS@ $(cppflags)

bzlib_objs = \
	blocksort.o  \
	huffman.o    \
	crctable.o   \
	randtable.o  \
	compress.o   \
	decompress.o \
	bzlib.o      \
	bzread.o

all: libbz.o

libbz.o: $(bzlib_objs)
	$(LD) -o libbz.o $(bzlib_objs)

bzread.o: bzread.c
	$(CC) $(BZFILE_CFLAGS) -c -o bzread.o bzread.c

depend:
	cp -f Makefile Makefile.old
	sed '/^# DO NOT REMOVE THIS LINE/q' < Makefile.old > Makefile
	gcc -MM $(CFLAGS) *.c >> Makefile

# DO NOT REMOVE THIS LINE, OR "make depend" WILL NOT WORK
